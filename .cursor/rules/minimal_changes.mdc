---
description:
globs:
  - "**/*.py"
  - "**/*.md"
  - "app.py"
  - "components/**/*.py"
  - "utils/**/*.py"
alwaysApply: true
---

# Minimal Change Rules

- Testing & verification:
  - For substantial code changes (new files, new functionality), write tests first in `tests/` that describe expected behavior.
  - Skip tests for UI/frontend changes, trivial additions, and documentation.
  - After implementing changes, run `pytest` to verify all tests pass.
  - If tests fail, iterate on debugging until fixed.

- Plan first:
  - Update `todo.md` with the smallest next actions tied to `plans.md`.
  - Keep tasks atomic and check them off as you go.
  - Use the `conductor` folder to learn about the project. Maintain this folder after every change to the code in order to keep running memory (only make changes if necessary).

- Keep edits minimal:
  - Prefer small, surgical changes over refactors.
  - Reuse existing files: `app.py`, `components/sidebar.py`, `components/main_panel.py`, `utils/*`.
  - Remove or simplify clearly unnecessary code only when it reduces complexity.

- Comments & style:
  - Add concise comments explaining intent where the change is non-obvious.
  - Do not reformat unrelated code or alter indentation styles.

- Git workflow:
  - After each coherent set of changes:
    - git commit -am "[short, concise, and helpful message about what was done]"
  - Between features:
    - git push
    - git checkout -b feature/<short-name>
  - Never merge branches.

- Ongoing planning:
  - Keep `todo.md` current before/after each change.
  - Update `plans.md` if scope/ideas evolve.

- Research as needed:
  - If details are unclear (e.g., detection thresholds), research your options and make a minimal reasonable choice and note it in `todo.md`.

  # Guardrails

- Avoid adding new dependencies unless strictly needed.
- Avoid creating new modules/components unless existing ones cannot be cleanly extended.
- Ensure Dash callbacks remain responsive; avoid heavy sync work in callbacks without feedback indicators.